var M=Object.defineProperty,S=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var y=(t,i,a)=>i in t?M(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a,d=(t,i)=>{for(var a in i||(i={}))U.call(i,a)&&y(t,a,i[a]);if(v)for(var a of v(i))E.call(i,a)&&y(t,a,i[a]);return t},x=(t,i)=>S(t,T(i));var h=(t,i,a)=>new Promise((f,n)=>{var o=r=>{try{l(a.next(r))}catch(c){n(c)}},u=r=>{try{l(a.throw(r))}catch(c){n(c)}},l=r=>r.done?f(r.value):Promise.resolve(r.value).then(o,u);l((a=a.apply(t,i)).next())});import{j as e,t as k,u as O,v as z,a5 as q,a6 as B}from"./ui-vendor.js";import{r as m}from"./react-vendor.js";import{d as j}from"./db.js";import{B as p}from"./button.js";import{I as N}from"./input.js";import{T as F}from"./textarea.js";import{C as H,a as L,b as P,c as R}from"./card.js";import{D as V,a as A,b as G,c as J,d as K}from"./dialog.js";import{u as Q}from"./index.js";import"./api2.js";import"./query.js";const le=()=>{const{toast:t}=Q(),[i,a]=m.useState([]),[f,n]=m.useState(!1),[o,u]=m.useState(null),[l,r]=m.useState({title:"",description:"",fileUrl:"",type:"image",tags:[]});m.useEffect(()=>{c()},[]);const c=()=>h(void 0,null,function*(){try{const s=yield j.getMedia();a(s)}catch(s){console.error("Ошибка при загрузке медиа:",s),a([]),t({variant:"destructive",title:"Ошибка",description:"Ошибка при загрузке медиа файлов"})}}),b=s=>h(void 0,null,function*(){s.preventDefault();try{o?(yield j.updateMedia(o.id,l),t({title:"Успех",description:"Медиа файл обновлен"})):(yield j.createMedia(x(d({},l),{date:new Date().toISOString()})),t({title:"Успех",description:"Медиа файл создан"})),n(!1),c(),g()}catch(D){t({variant:"destructive",title:"Ошибка",description:"Произошла ошибка"})}}),w=s=>{u(s),r({title:s.title,description:s.description,fileUrl:s.fileUrl,type:s.type,tags:s.tags}),n(!0)},C=s=>h(void 0,null,function*(){if(window.confirm("Вы уверены, что хотите удалить этот медиа файл?"))try{yield j.deleteMedia(s),t({title:"Успех",description:"Медиа файл удален"}),c()}catch(D){t({variant:"destructive",title:"Ошибка",description:"Ошибка при удалении медиа файла"})}}),g=()=>{u(null),r({title:"",description:"",fileUrl:"",type:"image",tags:[]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Управление медиа"}),e.jsxs(V,{open:f,onOpenChange:n,children:[e.jsx(A,{asChild:!0,children:e.jsxs(p,{onClick:()=>g(),children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Добавить медиа"]})}),e.jsxs(G,{className:"max-w-2xl",children:[e.jsx(J,{children:e.jsx(K,{children:o?"Редактировать медиа":"Новый медиа файл"})}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Название"}),e.jsx(N,{value:l.title,onChange:s=>r(x(d({},l),{title:s.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Описание"}),e.jsx(F,{value:l.description,onChange:s=>r(x(d({},l),{description:s.target.value})),className:"min-h-[100px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"URL файла"}),e.jsx(N,{value:l.fileUrl,onChange:s=>r(x(d({},l),{fileUrl:s.target.value})),required:!0,placeholder:"https://example.com/file.jpg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Тип"}),e.jsxs("select",{value:l.type,onChange:s=>r(x(d({},l),{type:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"image",children:"Изображение"}),e.jsx("option",{value:"video",children:"Видео"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Отмена"}),e.jsx(p,{type:"submit",children:o?"Сохранить":"Создать"})]})]})]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:i.map(s=>e.jsxs(H,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(P,{className:"text-lg font-medium line-clamp-2",children:s.title}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(p,{variant:"outline",size:"sm",onClick:()=>w(s),children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx(p,{variant:"outline",size:"sm",onClick:()=>C(s.id),children:e.jsx(z,{className:"h-4 w-4"})})]})]}),e.jsxs(R,{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[s.type==="image"?e.jsx(q,{className:"h-4 w-4 mr-2 text-blue-500"}):e.jsx(B,{className:"h-4 w-4 mr-2 text-red-500"}),e.jsx("span",{className:"text-sm text-gray-500 capitalize",children:s.type})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-3 mb-2",children:s.description}),e.jsx("div",{className:"text-xs text-gray-400",children:new Date(s.date).toLocaleDateString()})]})]},s.id))})]})};export{le as default};
//# sourceMappingURL=MediaManagement.js.map
