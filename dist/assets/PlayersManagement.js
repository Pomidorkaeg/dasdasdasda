var E=Object.defineProperty,L=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var F=(s,a,r)=>a in s?E(s,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[a]=r,j=(s,a)=>{for(var r in a||(a={}))T.call(a,r)&&F(s,r,a[r]);if(S)for(var r of S(a))q.call(a,r)&&F(s,r,a[r]);return s},y=(s,a)=>L(s,I(a));var f=(s,a,r)=>new Promise((l,o)=>{var c=t=>{try{n(r.next(t))}catch(d){o(d)}},i=t=>{try{n(r.throw(t))}catch(d){o(d)}},n=t=>t.done?l(t.value):Promise.resolve(t.value).then(c,i);n((r=r.apply(s,a)).next())});import{j as e,X as _,s as M,g as z,t as B,u as H,v as R}from"./ui-vendor.js";import{r as p}from"./react-vendor.js";import{B as w}from"./button.js";import{I as h}from"./input.js";import{L as m}from"./label.js";import{d as N}from"./db.js";import{t as v}from"./index.js";import{C as U,a as A,b as G}from"./card.js";import{D as W}from"./DeletePlayerDialog.js";import"./api2.js";import"./query.js";import"./dialog.js";const X=({formData:s,handleChange:a})=>{const[r,l]=p.useState([]),[o,c]=p.useState(!0);p.useEffect(()=>{f(void 0,null,function*(){try{const t=yield N.getTeams();console.log("Loaded teams:",t),l(t)}catch(t){console.error("Error loading teams:",t)}finally{c(!1)}})},[]);const i=n=>{const t=n.target.value,d=r.find(b=>b.id===t);a({target:{name:"team_id",value:t}});const g={target:{name:"team_name",value:(d==null?void 0:d.name)||""}};a(g)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Основная информация"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"team_id",children:"Команда"}),e.jsxs("select",{id:"team_id",name:"team_id",value:s.team_id,onChange:i,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",required:!0,disabled:o,children:[e.jsx("option",{value:"",children:"Выберите команду"}),r.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"name",children:"Имя"}),e.jsx(h,{id:"name",name:"name",value:s.name,onChange:a,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"position",children:"Позиция"}),e.jsxs("select",{id:"position",name:"position",value:s.position,onChange:a,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",required:!0,children:[e.jsx("option",{value:"",children:"Выберите позицию"}),e.jsx("option",{value:"Вратарь",children:"Вратарь"}),e.jsx("option",{value:"Защитник",children:"Защитник"}),e.jsx("option",{value:"Полузащитник",children:"Полузащитник"}),e.jsx("option",{value:"Нападающий",children:"Нападающий"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"number",children:"Номер"}),e.jsx(h,{id:"number",name:"number",type:"number",min:"1",max:"99",value:s.number,onChange:a,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"nationality",children:"Национальность"}),e.jsx(h,{id:"nationality",name:"nationality",value:s.nationality,onChange:a,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"age",children:"Возраст"}),e.jsx(h,{id:"age",name:"age",type:"number",min:"16",max:"45",value:s.age,onChange:a,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"photo",children:"Фото URL"}),e.jsx(h,{id:"photo",name:"photo",type:"url",value:s.photo,onChange:a,placeholder:"https://example.com/photo.jpg"})]})]})},J=({formData:s,handleChange:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Физические характеристики"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"height",children:"Рост (см)"}),e.jsx(h,{id:"height",name:"height",type:"number",min:"150",max:"220",value:s.height,onChange:a,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"weight",children:"Вес (кг)"}),e.jsx(h,{id:"weight",name:"weight",type:"number",min:"50",max:"120",value:s.weight,onChange:a,required:!0})]})]}),K=({formData:s,handleChange:a})=>{var l,o,c,i,n;const r=(t,d)=>{const g={target:{name:"stats",value:y(j({},s.stats),{[t]:parseInt(d)||0})}};a(g)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Статистика матчей"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"games",children:"Игр сыграно"}),e.jsx(h,{id:"games",type:"number",min:"0",value:((l=s.stats)==null?void 0:l.games)||0,onChange:t=>r("games",t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"goals",children:"Голов"}),e.jsx(h,{id:"goals",type:"number",min:"0",value:((o=s.stats)==null?void 0:o.goals)||0,onChange:t=>r("goals",t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"assists",children:"Голевых передач"}),e.jsx(h,{id:"assists",type:"number",min:"0",value:((c=s.stats)==null?void 0:c.assists)||0,onChange:t=>r("assists",t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"yellowCards",children:"Жёлтых карточек"}),e.jsx(h,{id:"yellowCards",type:"number",min:"0",value:((i=s.stats)==null?void 0:i.yellowCards)||0,onChange:t=>r("yellowCards",t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"redCards",children:"Красных карточек"}),e.jsx(h,{id:"redCards",type:"number",min:"0",value:((n=s.stats)==null?void 0:n.redCards)||0,onChange:t=>r("redCards",t.target.value)})]})]})]})},O={teamId:"",teamName:"",name:"",position:"",number:0,nationality:"",age:0,height:0,weight:0,photo:"",stats:{games:0,goals:0,assists:0,yellowCards:0,redCards:0}},Q=({player:s,onSave:a,onCancel:r})=>{const[l,o]=p.useState(s||O),c=n=>{const{name:t,value:d}=n.target;if(t==="stats")o(u=>y(j({},u),{stats:d}));else if(t.startsWith("stats.")){const u=t.split(".")[1];o(g=>y(j({},g),{stats:y(j({},g.stats),{[u]:Number(d)})}))}else o(u=>y(j({},u),{[t]:t==="number"||t==="age"||t==="height"||t==="weight"?Number(d):d}))},i=n=>{n.preventDefault(),a(l)};return e.jsxs("form",{onSubmit:i,className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:s?"Редактировать игрока":"Добавить нового игрока"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(w,{type:"button",variant:"outline",size:"sm",onClick:r,children:[e.jsx(_,{className:"mr-2 h-4 w-4"})," Отмена"]}),e.jsxs(w,{type:"submit",size:"sm",children:[e.jsx(M,{className:"mr-2 h-4 w-4"})," Сохранить"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(X,{formData:l,handleChange:c}),e.jsx(J,{formData:l,handleChange:c})]}),e.jsx("div",{children:e.jsx(K,{formData:l,handleChange:c})})]})]})},V=({onAddClick:s,searchTerm:a,onSearchChange:r})=>e.jsx(U,{className:"mb-8 bg-gradient-to-br from-white to-gray-50",children:e.jsxs(A,{className:"flex flex-row items-center justify-between",children:[e.jsx(G,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full mr-3 flex items-center justify-center bg-fc-green",children:e.jsx(z,{className:"h-4 w-4 text-white"})}),e.jsx("span",{children:"Управление игроками"})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(h,{type:"text",placeholder:"Поиск игроков...",value:a,onChange:l=>r(l.target.value),className:"w-64"}),e.jsxs(w,{onClick:s,className:"bg-fc-green hover:bg-fc-darkGreen",children:[e.jsx(B,{className:"mr-2 h-4 w-4"})," Добавить игрока"]})]})]})}),Y=({players:s,onEdit:a,onPlayersChange:r})=>{const[l,o]=p.useState(null),c=i=>f(void 0,null,function*(){try{yield N.deletePlayer(i),v({title:"Успех",description:"Игрок успешно удален"}),r()}catch(n){console.error("Error deleting player:",n),v({title:"Ошибка",description:"Не удалось удалить игрока",variant:"destructive"})}});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white rounded-lg shadow",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 border-b",children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Игрок"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Позиция"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Номер"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Возраст"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Национальность"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:s.map(i=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 flex-shrink-0",children:e.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:i.photo||"/default-player.png",alt:i.name})}),e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:i.name})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:i.position})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:i.number})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:i.age})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:i.nationality})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>a(i),className:"text-gray-600 hover:text-gray-900",children:e.jsx(H,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>o(i),className:"text-red-600 hover:text-red-900",children:e.jsx(R,{className:"h-4 w-4"})})]})})]},i.id))})]})})}),e.jsx(W,{player:l,onClose:()=>o(null),onConfirm:()=>c((l==null?void 0:l.id)||"")})]})},oe=()=>{const[s,a]=p.useState([]),[r,l]=p.useState(""),[o,c]=p.useState(!1),[i,n]=p.useState(null),[t,d]=p.useState(!0);p.useEffect(()=>{u()},[]);const u=()=>f(void 0,null,function*(){try{d(!0);const x=yield N.getPlayers();a(x)}catch(x){console.error("Error loading players:",x),v({title:"Ошибка загрузки",description:x instanceof Error?x.message:"Не удалось загрузить список игроков",variant:"destructive"}),a([])}finally{d(!1)}}),g=x=>{n(x),c(!0)},b=x=>f(void 0,null,function*(){try{i?(yield N.updatePlayer(i.id,x),v({title:"Успех",description:"Игрок успешно обновлен"})):(yield N.createPlayer(x),v({title:"Успех",description:"Игрок успешно создан"})),c(!1),n(null),yield u()}catch(C){console.error("Error saving player:",C),v({title:"Ошибка сохранения",description:C instanceof Error?C.message:"Не удалось сохранить игрока",variant:"destructive"})}}),k=()=>{c(!1),n(null)},P=s.filter(x=>x.name.toLowerCase().includes(r.toLowerCase())||x.position.toLowerCase().includes(r.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{onAddClick:()=>c(!0),searchTerm:r,onSearchChange:l}),o?e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsx(Q,{player:i||void 0,onSave:b,onCancel:k})}):e.jsx(e.Fragment,{children:t?e.jsx("div",{className:"text-center py-4",children:"Загрузка игроков..."}):P.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:r?"Игроки не найдены":"Нет доступных игроков"}):e.jsx(Y,{players:P,onEdit:g,onPlayersChange:u})})]})};export{oe as default};
//# sourceMappingURL=PlayersManagement.js.map
